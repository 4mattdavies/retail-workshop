{
  "paragraphs": [
    {
      "text": "%md\n# Natural Language Processing \u0026 ML Pipeline\nThis notebook implements \u0026 explains the Azure Blob ingestion \u0026 NLP pipeline components of batch pipeline, steps 1-4.  Step 5 is implemented in a the ML_Training notebook\n![Image](https://precocityquboleout.blob.core.windows.net/images/Screen%20Shot%202018-01-25%20at%201.05.00%20PM.png)\n",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:20:48 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1516905440675_-1933126186",
      "id": "20180125-183720_494633819_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eNatural Language Processing \u0026amp; ML Pipeline\u003c/h1\u003e\n\u003cp\u003eThis notebook implements \u0026amp; explains the Azure Blob ingestion \u0026amp; NLP pipeline components of batch pipeline, steps 1-4. Step 5 is implemented in a the ML_Training notebook\u003cbr/\u003e\u003cimg src\u003d\"https://precocityquboleout.blob.core.windows.net/images/Screen%20Shot%202018-01-25%20at%201.05.00%20PM.png\" alt\u003d\"Image\" /\u003e\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 25, 2018 6:37:20 PM",
      "dateStarted": "Jan 25, 2018 7:44:29 PM",
      "dateFinished": "Jan 25, 2018 7:44:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//IMPORT CELL\nimport scala.collection.mutable.ListBuffer\nimport org.apache.spark.sql._\nimport org.apache.spark.ml.feature.{RegexTokenizer, Tokenizer}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.ml.feature.StopWordsRemover\nimport scala.collection.mutable.WrappedArray\n//import org.apache.spark.ml.feature.{HashingTF, IDF}\n//import org.apache.spark.ml.feature.NGram\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.LogisticRegression\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nimport org.apache.spark.ml.feature.{HashingTF, Tokenizer}\nimport org.apache.spark.ml.linalg.Vector\nimport org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\nimport org.apache.spark.sql.Row\nimport org.apache.spark.ml.feature.QuantileDiscretizer\nimport org.apache.spark.ml.feature.Bucketizer\nimport org.apache.spark.ml.linalg._\nimport org.apache.spark.mllib.linalg.distributed._",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:23:55 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "jobName": "paragraph_1513310993398_-1922442312",
      "id": "20171215-040953_335028120_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "\nimport scala.collection.mutable.ListBuffer\n\nimport org.apache.spark.sql._\n\nimport org.apache.spark.ml.feature.{RegexTokenizer, Tokenizer}\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.ml.feature.StopWordsRemover\n\nimport scala.collection.mutable.WrappedArray\n\nimport org.apache.spark.ml.feature._\n\nimport org.apache.spark.ml.Pipeline\n\nimport org.apache.spark.ml.classification.LogisticRegression\n\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nimport org.apache.spark.ml.feature.{HashingTF, Tokenizer}\n\nimport org.apache.spark.ml.linalg.Vector\n\nimport org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\n\nimport org.apache.spark.sql.Row\n\nimport org.apache.spark.ml.feature.QuantileDiscretizer\n\nimport org.apache.spark.ml.feature.Bucketizer\n\nimport org.apache.spark.ml.linalg._\n\nimport org.apache.spark.mllib.linalg.distributed._\n"
      },
      "dateCreated": "Dec 15, 2017 4:09:53 AM",
      "dateStarted": "Jan 27, 2018 11:23:55 AM",
      "dateFinished": "Jan 27, 2018 11:25:07 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Ingestion from Azure Blob into Quoble/Spark Dataframe\n\n* Our raw review data is in json format in `product-reviews` container in Azure Blob storage\n* We ingest into a DataFrame within Qubole\u0027s Spark cluster with a single `sqlContext.read.json` command\n* Issue the createOrReplaceTempView command registers our `inputDf` dataframe as the Spark.SQL table `all_reviews` so that we can query it with normal SQL later",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 25, 2018 6:41:37 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515012617693_-1628484423",
      "id": "20180103-205017_99358902_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eIngestion from Azure Blob into Quoble/Spark Dataframe\u003c/h1\u003e\n\u003cul\u003e\n  \u003cli\u003eOur raw review data is in json format in \u003ccode\u003eproduct-reviews\u003c/code\u003e container in Azure Blob storage\u003c/li\u003e\n  \u003cli\u003eWe ingest into a DataFrame within Qubole\u0026rsquo;s Spark cluster with a single \u003ccode\u003esqlContext.read.json\u003c/code\u003e command\u003c/li\u003e\n  \u003cli\u003eIssue the createOrReplaceTempView command registers our \u003ccode\u003einputDf\u003c/code\u003e dataframe as the Spark.SQL table \u003ccode\u003eall_reviews\u003c/code\u003e so that we can query it with normal SQL later\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 3, 2018 8:50:17 PM",
      "dateStarted": "Jan 25, 2018 6:41:32 PM",
      "dateFinished": "Jan 25, 2018 6:41:32 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//INGESTION CELL\nvar inputDf \u003d sqlContext.read.json(\"wasb://product-reviews@precocityquboleout.blob.core.windows.net/reviews_Electronics_5.json\") \ninputDf \u003d inputDf.withColumn(\"Category\",lit(\"Electronics\"))\ninputDf.createOrReplaceTempView(\"all_reviews\")",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:26:02 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 0,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d0",
            "numTasks": 3,
            "numCompletedTasks": 3,
            "stages": [
              {
                "id": 0,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d0\u0026attempt\u003d0",
                "numCompleteTasks": 3,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 3
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 3,
        "numTasks": 3,
        "truncated": false
      },
      "jobName": "paragraph_1515592490982_-348148161",
      "id": "20180110-135450_333212547_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 1:54:50 PM",
      "dateStarted": "Jan 27, 2018 11:26:02 AM",
      "dateFinished": "Jan 27, 2018 11:26:25 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Let\u0027s look at the schema of the data",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515592760157_-921440991",
      "id": "20180110-135920_249521663_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eLet\u0026rsquo;s look at the schema of the data\u003c/h1\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 1:59:20 PM",
      "dateStarted": "Jan 20, 2018 1:07:29 PM",
      "dateFinished": "Jan 20, 2018 1:07:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//PRINTSCHEMA CELL\ninputDf.printSchema",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:26:44 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "jobName": "paragraph_1515592817112_1923685180",
      "id": "20180110-140017_1364279757_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 2:00:17 PM",
      "dateStarted": "Jan 27, 2018 11:26:44 AM",
      "dateFinished": "Jan 27, 2018 11:26:44 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Key column definitions:\n\n* **asin**: Product ID\n* **helpful**: Array of 2 values. 1st value is # of times this review was voted helpful (upVotes), 2nd value is the total # of votes on this review\n* **overall**: The 1 to 5 star rating of the product\n* **reviewText**: The raw text of the actual review itself",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515592844615_-610225104",
      "id": "20180110-140044_1561032633_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eKey column definitions:\u003c/h1\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003cstrong\u003easin\u003c/strong\u003e: Product ID\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003ehelpful\u003c/strong\u003e: Array of 2 values. 1st value is # of times this review was voted helpful (upVotes), 2nd value is the total # of votes on this review\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003eoverall\u003c/strong\u003e: The 1 to 5 star rating of the product\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003ereviewText\u003c/strong\u003e: The raw text of the actual review itself\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 2:00:44 PM",
      "dateStarted": "Jan 20, 2018 1:07:29 PM",
      "dateFinished": "Jan 20, 2018 1:07:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Let\u0027s look at few rows of raw data",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515592715793_1023602616",
      "id": "20180110-135835_584406976_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eLet\u0026rsquo;s look at few rows of raw data\u003c/h1\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 1:58:35 PM",
      "dateStarted": "Jan 20, 2018 1:07:29 PM",
      "dateFinished": "Jan 20, 2018 1:07:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//RAW ROWS CELL\ninputDf.show()",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:22:46 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 1,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516903941734_0001/jobs/job?spark\u003dtrue\u0026id\u003d1",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 1,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516903941734_0001/stages/stage/?id\u003d1\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 1,
        "numTasks": 1,
        "truncated": false
      },
      "jobName": "paragraph_1516652273363_751280833",
      "id": "20180122-201753_1042708266_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 22, 2018 8:17:53 PM",
      "dateStarted": "Jan 25, 2018 6:43:12 PM",
      "dateFinished": "Jan 25, 2018 6:43:13 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Derived Features\nLet\u0027s compute some additional columns that will be helpful for machine learning\n\n* **upVotes**: Extract out the 1st value in helpful column\n* **totalVotes**: 2nd value in helpful column\n* **fullReview**: Concatenate the summary \u0026 reviewText features into one column\n* **score**: Compute a measure of helpfulness as the ratio of upVotes to totalVotes",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515593657604_-2017884532",
      "id": "20180110-141417_656842185_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eDerived Features\u003c/h1\u003e\n\u003cp\u003eLet\u0026rsquo;s compute some additional columns that will be helpful for machine learning\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003cstrong\u003eupVotes\u003c/strong\u003e: Extract out the 1st value in helpful column\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003etotalVotes\u003c/strong\u003e: 2nd value in helpful column\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003efullReview\u003c/strong\u003e: Concatenate the summary \u0026amp; reviewText features into one column\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003escore\u003c/strong\u003e: Compute a measure of helpfulness as the ratio of upVotes to totalVotes\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 2:14:17 PM",
      "dateStarted": "Jan 20, 2018 1:07:29 PM",
      "dateFinished": "Jan 20, 2018 1:07:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//DERIVED CELL\nvar derivedDF \u003d inputDf.withColumn(\"upVotes\", $\"helpful\".getItem(0))\nderivedDF \u003d derivedDF.withColumn(\"totalVotes\", $\"helpful\".getItem(1))\nderivedDF \u003d derivedDF.withColumn(\"fullReview\", concat(derivedDF(\"summary\"), lit(\" \"), derivedDF(\"reviewText\")))\nderivedDF \u003d derivedDF.withColumn(\"score\",derivedDF(\"upVotes\")/derivedDF(\"totalVotes\"))\nderivedDF.createOrReplaceTempView(\"all_reviews\")\nderivedDF \u003d sqlContext.sql(\"select *,from_unixtime(unixReviewTime,\u0027YYYY-MM-dd\u0027) as reviewDate, case when score \u003c\u003d 0.8 then 0 else 1 end as label from all_reviews\")\nderivedDF.createOrReplaceTempView(\"all_reviews\")\nderivedDF.select(\"asin\",\"upVotes\",\"totalVotes\",\"score\",\"label\").show()",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:33:20 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 2,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d2",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 2,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d2\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 1,
        "numTasks": 1,
        "truncated": false
      },
      "jobName": "paragraph_1515599944425_254605507",
      "id": "20180110-155904_1749793674_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 3:59:04 PM",
      "dateStarted": "Jan 27, 2018 11:32:56 AM",
      "dateFinished": "Jan 27, 2018 11:32:58 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Total Vote Analysis - Qubole Notebook Interactivity\nUsing Qubole Notebook\u0027s built in **dynamic form** and **visualization** capabilities, let\u0027s analyze how the distribution of overall product ratings (1-5 star ratings) change as we filter out reviews with small number of total of votes",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 12:01:54 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1517054275641_1968197029",
      "id": "20180127-115755_1132206118_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eTotal Vote Analysis - Qubole Notebook Interactivity\u003c/h1\u003e\n\u003cp\u003eUsing Qubole Notebook\u0026rsquo;s built in \u003cstrong\u003edynamic form\u003c/strong\u003e and \u003cstrong\u003evisualization\u003c/strong\u003e capabilities, let\u0026rsquo;s analyze how the distribution of overall product ratings (1-5 star ratings) change as we filter out reviews with small number of total of votes\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 27, 2018 11:57:55 AM",
      "dateStarted": "Jan 27, 2018 12:01:09 PM",
      "dateFinished": "Jan 27, 2018 12:01:10 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.sql --TOTAL VOTE CELL\nselect overall,count(*) as cnt from all_reviews where totalVotes \u003e\u003d \"${LowerBoundOnTotalVotes\u003d0}\" group by overall order by overall",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 12:03:57 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "pieChart",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "overall",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "cnt",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "overall",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "cnt",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "enabled": true,
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {
          "limit": "10",
          "LowerBoundOnTotalVotes": "10"
        },
        "forms": {
          "LowerBoundOnTotalVotes": {
            "name": "LowerBoundOnTotalVotes",
            "defaultValue": "0",
            "hidden": false
          }
        }
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 27,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d27",
            "numTasks": 212,
            "numCompletedTasks": 212,
            "stages": [
              {
                "id": 42,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d42\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              },
              {
                "id": 43,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d43\u0026attempt\u003d0",
                "numCompleteTasks": 200,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 200
              }
            ],
            "status": "Running"
          }
        ],
        "numCompletedTasks": 212,
        "numTasks": 212,
        "truncated": false
      },
      "jobName": "paragraph_1517053988502_409364696",
      "id": "20180127-115308_785965316_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 27, 2018 11:53:08 AM",
      "dateStarted": "Jan 27, 2018 12:03:34 PM",
      "dateFinished": "Jan 27, 2018 12:03:43 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Filter\nReviews with less then 10 totalVotes are likely to have insufficent feedback to be considered meaningful.  Let\u0027s filter those out\n",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515593898988_-1445441110",
      "id": "20180110-141818_1223639840_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eFilter\u003c/h1\u003e\n\u003cp\u003eReviews with less then 10 totalVotes are likely to have insufficent feedback to be considered meaningful. Let\u0026rsquo;s filter those out\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 2:18:18 PM",
      "dateStarted": "Jan 20, 2018 1:07:29 PM",
      "dateFinished": "Jan 20, 2018 1:07:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//FILTER CELL\nvar df \u003d derivedDF.filter(\"totalVotes \u003e 10\")\ndf.createOrReplaceTempView(\"reviews\")",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:33:40 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "jobName": "paragraph_1515594030062_1307801238",
      "id": "20180110-142030_358578607_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 2:20:30 PM",
      "dateStarted": "Jan 27, 2018 11:33:32 AM",
      "dateFinished": "Jan 27, 2018 11:33:32 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Tokenization \u0026 StopWord Removal - Steps 2 \u0026 3 in our Pipeline\n![Image](https://precocityquboleout.blob.core.windows.net/images/Screen%20Shot%202018-01-25%20at%201.05.00%20PM.png)\nLet\u0027s tokenize our single long `fullReview` columnn into an array of lower case strings",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:33:53 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515594249165_-1855129170",
      "id": "20180110-142409_503381931_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eTokenization \u0026amp; StopWord Removal - Steps 2 \u0026amp; 3 in our Pipeline\u003c/h1\u003e\n\u003cp\u003e\u003cimg src\u003d\"https://precocityquboleout.blob.core.windows.net/images/Screen%20Shot%202018-01-25%20at%201.05.00%20PM.png\" alt\u003d\"Image\" /\u003e\u003cbr/\u003eLet\u0026rsquo;s tokenize our single long \u003ccode\u003efullReview\u003c/code\u003e columnn into an array of lower case strings\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 2:24:09 PM",
      "dateStarted": "Jan 25, 2018 7:07:43 PM",
      "dateFinished": "Jan 25, 2018 7:07:43 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//TOKENIZE CELL\nval regexTokenizer \u003d new RegexTokenizer()\n  .setInputCol(\"fullReview\")\n  .setOutputCol(\"regexOutput\")\n  .setPattern(\"\\\\W\")\nvar tokenizedDF \u003d regexTokenizer.transform(df)\ntokenizedDF.createOrReplaceTempView(\"reviews\")\ntokenizedDF.select(\"asin\",\"fullReview\",\"regexOutput\").show()",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:34:37 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 3,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d3",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 3,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d3\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 1,
        "numTasks": 1,
        "truncated": false
      },
      "jobName": "paragraph_1515594275729_1287746678",
      "id": "20180110-142435_197011591_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 2:24:35 PM",
      "dateStarted": "Jan 27, 2018 11:34:38 AM",
      "dateFinished": "Jan 27, 2018 11:34:42 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# StopWord Removal\nLet\u0027s remove some common stop words that provide no signal or infomrmation for our predictive task",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515594478576_85866090",
      "id": "20180110-142758_1907212191_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eStopWord Removal\u003c/h1\u003e\n\u003cp\u003eLet\u0026rsquo;s remove some common stop words that provide no signal or infomrmation for our predictive task\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 2:27:58 PM",
      "dateStarted": "Jan 20, 2018 1:07:30 PM",
      "dateFinished": "Jan 20, 2018 1:07:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//STOPWORD CELL\nvar remover \u003d new StopWordsRemover()\n  .setInputCol(\"regexOutput\")\n  .setOutputCol(\"stopWordsOutput\")\n  \nvar stopWords \u003d Array(\"lens\",\"tv\",\"drive\",\"one\",\"case\",\"2\",\"video\",\"battery\",\"1\",\"screen\",\"unit\",\"camera\",\"usb\",\"3\",\"would\",\"also\",\"card\",\"sound\",\"use\") ++ remover.getStopWords\nremover \u003d remover.setStopWords(stopWords)\nvar filteredDF \u003d remover.transform(tokenizedDF)\nfilteredDF.select(\"asin\",\"regexOutput\",\"stopWordsOutput\").show()",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:40:04 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 4,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d4",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 4,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d4\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 1,
        "numTasks": 1,
        "truncated": false
      },
      "jobName": "paragraph_1515594490437_652631868",
      "id": "20180110-142810_931867535_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 2:28:10 PM",
      "dateStarted": "Jan 27, 2018 11:40:04 AM",
      "dateFinished": "Jan 27, 2018 11:40:06 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Compute number of words\nJust as a helper to display shorter reviews to fit on screen",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 25, 2018 7:01:03 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515616088408_-1598597337",
      "id": "20180110-202808_1151525844_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eCompute number of words\u003c/h1\u003e\n\u003cp\u003eJust as a helper to display shorter reviews to fit on screen\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 8:28:08 PM",
      "dateStarted": "Jan 25, 2018 7:00:59 PM",
      "dateFinished": "Jan 25, 2018 7:00:59 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//NUMWORDS CELL\nfilteredDF.createOrReplaceTempView(\"reviews\")\nval filterByLengthUDF \u003d sqlContext.udf.register(\"NumWords\", (x:WrappedArray[String]) \u003d\u003e x.length)\nvar numWordsDF \u003d sqlContext.sql(\"select *, NumWords(stopWordsOutput) as numWords from reviews\")\nnumWordsDF.createOrReplaceTempView(\"reviews\")",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:43:02 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "jobName": "paragraph_1515595029921_550427102",
      "id": "20180110-143709_254528079_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "\nfilterByLengthUDF: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction1\u003e,IntegerType,Some(List(ArrayType(StringType,true))))\n\nnumWordsDF: org.apache.spark.sql.DataFrame \u003d [asin: string, helpful: array\u003cbigint\u003e ... 17 more fields]\n"
      },
      "dateCreated": "Jan 10, 2018 2:37:09 PM",
      "dateStarted": "Jan 27, 2018 11:40:24 AM",
      "dateFinished": "Jan 27, 2018 11:40:25 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# BiGrams\nBigrams are 2 consecutive tokens/words and can better capture the sequential nature of reviews than just single words.  ",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515614600712_-183019646",
      "id": "20180110-200320_2022445575_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eBiGrams\u003c/h1\u003e\n\u003cp\u003eBigrams are 2 consecutive tokens/words and can better capture the sequential nature of reviews than just single words.\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 10, 2018 8:03:20 PM",
      "dateStarted": "Jan 20, 2018 1:07:30 PM",
      "dateFinished": "Jan 20, 2018 1:07:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//BIGRAM CELL\nimport scala.collection.mutable.WrappedArray\nval bigramTF \u003d new NGram().setN(2).setInputCol(\"stopWordsOutput\").setOutputCol(\"bigrams\")\nval bigramDf \u003d bigramTF.transform(numWordsDF)\nval concat2ArraysUDF \u003d udf { (uni: WrappedArray[String],bi:WrappedArray[String]) \u003d\u003e uni ++ bi }\n//concat words \u0026 bigrams into one column called uniAndBi\nvar newTF \u003d bigramDf.withColumn(\"uniAndBi\",concat2ArraysUDF(bigramDf(\"stopWordsOutput\"), bigramDf(\"bigrams\")))\nnewTF.createOrReplaceTempView(\"reviews\")\nspark.sql(\"select asin, stopWordsOutput,bigrams from reviews where numWords \u003c 10 limit 5\").show(false)",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:43:02 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 6,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d6",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 6,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d6\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 1,
        "numTasks": 1,
        "truncated": false
      },
      "jobName": "paragraph_1515601095577_-1568115310",
      "id": "20180110-161815_1524737661_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 4:18:15 PM",
      "dateStarted": "Jan 27, 2018 11:41:09 AM",
      "dateFinished": "Jan 27, 2018 11:41:11 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Featurization - Step 4\n![Image](https://precocityquboleout.blob.core.windows.net/images/Screen%20Shot%202018-01-25%20at%201.05.00%20PM.png)\nBefore applying Machine Learning (ML) models, we\u0027ll need to featurize our bigrams into numeric values. \n**Term Frequency - Inverse Document Frequency (TF-IDF)** is a very popular featurization method that scales well to large datasets. \n\nSpark\u0027s CountVectorizer applies a TF algorithm to in InputCol \u0026 returns a SparseVector that contains the word indices \u0026 their counts\n",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:41:24 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515676750187_298409029",
      "id": "20180111-131910_263021081_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eFeaturization - Step 4\u003c/h1\u003e\n\u003cp\u003e\u003cimg src\u003d\"https://precocityquboleout.blob.core.windows.net/images/Screen%20Shot%202018-01-25%20at%201.05.00%20PM.png\" alt\u003d\"Image\" /\u003e\u003cbr/\u003eBefore applying Machine Learning (ML) models, we\u0026rsquo;ll need to featurize our bigrams into numeric values.\u003cbr/\u003e\u003cstrong\u003eTerm Frequency - Inverse Document Frequency (TF-IDF)\u003c/strong\u003e is a very popular featurization method that scales well to large datasets. \u003c/p\u003e\n\u003cp\u003eSpark\u0026rsquo;s CountVectorizer applies a TF algorithm to in InputCol \u0026amp; returns a SparseVector that contains the word indices \u0026amp; their counts\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 11, 2018 1:19:10 PM",
      "dateStarted": "Jan 25, 2018 7:07:50 PM",
      "dateFinished": "Jan 25, 2018 7:07:50 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//TERM FREQUENCY CELL\nvar countTF \u003d new CountVectorizer().setInputCol(\"bigrams\").setOutputCol(\"countFeatures\")\nvar badProducts \u003d newTF.filter(\"overall \u003c 2\")\nvar countModel \u003d countTF.fit(badProducts)\nvar featurizedData \u003d countModel.transform(badProducts)\nfeaturizedData.filter(\"numWords \u003c 50\").select(\"asin\",\"Category\",\"countFeatures\").show(false)",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:43:40 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 7,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d7",
            "numTasks": 24,
            "numCompletedTasks": 24,
            "stages": [
              {
                "id": 7,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d7\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              },
              {
                "id": 8,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d8\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              }
            ],
            "status": "Success"
          },
          {
            "id": 8,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d8",
            "numTasks": 24,
            "numCompletedTasks": 12,
            "stages": [
              {
                "id": 9,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d9\u0026attempt\u003d0",
                "numCompleteTasks": 0,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 0
              },
              {
                "id": 10,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d10\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              }
            ],
            "status": "Success"
          },
          {
            "id": 9,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d9",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 11,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d11\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 37,
        "numTasks": 49,
        "truncated": false
      },
      "jobName": "paragraph_1515594859879_-1776919518",
      "id": "20180110-143419_95178827_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 2:34:19 PM",
      "dateStarted": "Jan 27, 2018 11:41:54 AM",
      "dateFinished": "Jan 27, 2018 11:42:13 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nSee out we\u0027ve now featurized our text into a numeric features represented in the `countFeatures` column.  This column contains SparseVector in the form (totalSize,[wordIndicesForThisReview],[wordCountsForThisReview])",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515682444285_1152855829",
      "id": "20180111-145404_1950049737_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eSee out we\u0026rsquo;ve now featurized our text into a numeric features represented in the \u003ccode\u003ecountFeatures\u003c/code\u003e column. This column contains SparseVector in the form (totalSize,[wordIndicesForThisReview],[wordCountsForThisReview])\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 11, 2018 2:54:04 PM",
      "dateStarted": "Jan 20, 2018 1:07:30 PM",
      "dateFinished": "Jan 20, 2018 1:07:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Most Common Bigrams of Bad Products\nThe `countModel` contains a vocabulary in descending count order, so let\u0027s view the most common bigrams first",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515682669292_1414806889",
      "id": "20180111-145749_998476415_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eMost Common Bigrams of Bad Products\u003c/h1\u003e\n\u003cp\u003eThe \u003ccode\u003ecountModel\u003c/code\u003e contains a vocabulary in descending count order, so let\u0026rsquo;s view the most common bigrams first\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 11, 2018 2:57:49 PM",
      "dateStarted": "Jan 20, 2018 1:07:30 PM",
      "dateFinished": "Jan 20, 2018 1:07:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//MOST COMMON BIGRAMS OF BAD PRODUCTS CELL\nvar wordsRDD \u003d sc.parallelize(countModel.vocabulary)\nvar wordDF \u003d wordsRDD.zipWithIndex().toDF(\"word\",\"rank\")\nwordDF.show(40,false)",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:46:43 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 10,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d10",
            "numTasks": 7,
            "numCompletedTasks": 7,
            "stages": [
              {
                "id": 12,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d12\u0026attempt\u003d0",
                "numCompleteTasks": 7,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 7
              }
            ],
            "status": "Success"
          },
          {
            "id": 11,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d11",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 13,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d13\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 8,
        "numTasks": 8,
        "truncated": false
      },
      "jobName": "paragraph_1515595679847_-1770226666",
      "id": "20180110-144759_1956047491_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 10, 2018 2:47:59 PM",
      "dateStarted": "Jan 27, 2018 11:45:18 AM",
      "dateFinished": "Jan 27, 2018 11:45:19 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nRecall we filtered on reviews of just the bad products rated \u003c 1, so it is intuitive that bigrams such as `customer service`, `waste money`, `stopped working`, \u0026 `piece junk` are among the most frequent",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515682850787_-1572555426",
      "id": "20180111-150050_1147079889_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eRecall we filtered on reviews of just the bad products rated \u0026lt; 1, so it is intuitive that bigrams such as \u003ccode\u003ecustomer service\u003c/code\u003e, \u003ccode\u003ewaste money\u003c/code\u003e, \u003ccode\u003estopped working\u003c/code\u003e, \u0026amp; \u003ccode\u003epiece junk\u003c/code\u003e are among the most frequent\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 11, 2018 3:00:50 PM",
      "dateStarted": "Jan 20, 2018 1:07:30 PM",
      "dateFinished": "Jan 20, 2018 1:07:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Most Common Bigrams of Good Products\nNow let\u0027s compute the Term Frequency of reviews of good products",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:30 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515683224901_-793498032",
      "id": "20180111-150704_2032838349_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eMost Common Bigrams of Good Products\u003c/h1\u003e\n\u003cp\u003eNow let\u0026rsquo;s compute the Term Frequency of reviews of good products\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 11, 2018 3:07:04 PM",
      "dateStarted": "Jan 20, 2018 1:07:30 PM",
      "dateFinished": "Jan 20, 2018 1:07:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//MOST COMMON BIGRAMS OF GOOD PRODUCTS CELL\nvar goodTF \u003d new CountVectorizer().setInputCol(\"bigrams\").setOutputCol(\"countFeatures\")\nvar goodProducts \u003d newTF.filter(\"overall \u003e 4\")\nvar goodTFModel \u003d goodTF.fit(goodProducts)\nvar bigramsRDD \u003d sc.parallelize(goodTFModel.vocabulary)\nvar bigramDF \u003d bigramsRDD.zipWithIndex().toDF(\"bigram\",\"rank\")\nbigramDF.show(20,false)",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:47:17 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 12,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d12",
            "numTasks": 24,
            "numCompletedTasks": 24,
            "stages": [
              {
                "id": 15,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d15\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              },
              {
                "id": 14,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d14\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              }
            ],
            "status": "Success"
          },
          {
            "id": 13,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d13",
            "numTasks": 24,
            "numCompletedTasks": 12,
            "stages": [
              {
                "id": 16,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d16\u0026attempt\u003d0",
                "numCompleteTasks": 0,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 0
              },
              {
                "id": 17,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d17\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              }
            ],
            "status": "Success"
          },
          {
            "id": 14,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d14",
            "numTasks": 7,
            "numCompletedTasks": 7,
            "stages": [
              {
                "id": 18,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d18\u0026attempt\u003d0",
                "numCompleteTasks": 7,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 7
              }
            ],
            "status": "Success"
          },
          {
            "id": 15,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/jobs/job?spark\u003dtrue\u0026id\u003d15",
            "numTasks": 1,
            "numCompletedTasks": 1,
            "stages": [
              {
                "id": 19,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1517051952301_0001/stages/stage/?id\u003d19\u0026attempt\u003d0",
                "numCompleteTasks": 1,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 1
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 44,
        "numTasks": 56,
        "truncated": false
      },
      "jobName": "paragraph_1515683277484_384895904",
      "id": "20180111-150757_504976278_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 11, 2018 3:07:57 PM",
      "dateStarted": "Jan 27, 2018 11:46:36 AM",
      "dateFinished": "Jan 27, 2018 11:46:57 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nFor the **good** products, it is also intuitive that bigrams such as `much better`, `works great`, `highly recommend`, \u0026 `works well` are among the most common",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:31 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515696937382_913521314",
      "id": "20180111-185537_1951062752_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eFor the \u003cstrong\u003egood\u003c/strong\u003e products, it is also intuitive that bigrams such as \u003ccode\u003emuch better\u003c/code\u003e, \u003ccode\u003eworks great\u003c/code\u003e, \u003ccode\u003ehighly recommend\u003c/code\u003e, \u0026amp; \u003ccode\u003eworks well\u003c/code\u003e are among the most common\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 11, 2018 6:55:37 PM",
      "dateStarted": "Jan 20, 2018 1:07:31 PM",
      "dateFinished": "Jan 20, 2018 1:07:31 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# Inverse Document Frequency (IDF)\n\n**Documment Frequency (DF)** \u003d how many documents contain the token\n**ID** \u003d the inverse of DF \u003d measure of rarity or relevance of a token",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 25, 2018 7:16:34 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1515786151456_-1593875224",
      "id": "20180112-194231_1575610508_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eInverse Document Frequency (IDF)\u003c/h1\u003e\n\u003cp\u003e\u003cstrong\u003eDocumment Frequency (DF)\u003c/strong\u003e \u003d how many documents contain the token\u003cbr/\u003e\u003cstrong\u003eID\u003c/strong\u003e \u003d the inverse of DF \u003d measure of rarity or relevance of a token\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 12, 2018 7:42:31 PM",
      "dateStarted": "Jan 20, 2018 1:07:31 PM",
      "dateFinished": "Jan 20, 2018 1:07:31 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//IDF ASCENDING ORDER\nvar featurizedData \u003d goodTFModel.transform(goodProducts)\nvar idf \u003d new IDF().setInputCol(\"countFeatures\").setOutputCol(\"idfFeatures\")\nvar idfModel \u003d idf.fit(featurizedData)\nvar rescaledData \u003d idfModel.transform(featurizedData)\nvar rdd \u003d rescaledData.rdd.map(row \u003d\u003e (row.getAs[SparseVector](\"countFeatures\").indices,row.getAs[SparseVector](\"countFeatures\").values,row.getAs[SparseVector](\"idfFeatures\").values))\nvar newRdd \u003d rdd.flatMap{case (as,bs,cs) \u003d\u003e (as zip bs zip cs).map{case ((a,b), c) \u003d\u003e (a,b,c)}}\nvar combDF \u003d newRdd.toDF(\"index\",\"count\",\"tfidf\")\nvar aggDF \u003d combDF.groupBy(\"index\").agg(sum(\"count\").alias(\"tf\"),avg(\"tfidf\").alias(\"meanTFIDF\"))\naggDF \u003d bigramDF.join(aggDF,\"index\")\naggDF.sort($\"meanTFIDF\".asc).show()",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:48:17 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 19,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/jobs/job?spark\u003dtrue\u0026id\u003d19",
            "numTasks": 15,
            "numCompletedTasks": 15,
            "stages": [
              {
                "id": 24,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/stages/stage/?id\u003d24\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              },
              {
                "id": 25,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/stages/stage/?id\u003d25\u0026attempt\u003d0",
                "numCompleteTasks": 3,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 3
              }
            ],
            "status": "Success"
          },
          {
            "id": 20,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/jobs/job?spark\u003dtrue\u0026id\u003d20",
            "numTasks": 420,
            "numCompletedTasks": 420,
            "stages": [
              {
                "id": 27,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/stages/stage/?id\u003d27\u0026attempt\u003d0",
                "numCompleteTasks": 200,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 200
              },
              {
                "id": 28,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/stages/stage/?id\u003d28\u0026attempt\u003d0",
                "numCompleteTasks": 8,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 8
              },
              {
                "id": 29,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/stages/stage/?id\u003d29\u0026attempt\u003d0",
                "numCompleteTasks": 200,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 200
              },
              {
                "id": 26,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.9%3A8088%2Fproxy%2Fapplication_1516630010812_0001/stages/stage/?id\u003d26\u0026attempt\u003d0",
                "numCompleteTasks": 12,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 12
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 435,
        "numTasks": 435,
        "truncated": false
      },
      "jobName": "paragraph_1514926961944_-1524740743",
      "id": "20180102-210241_267837947_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 2, 2018 9:02:41 PM",
      "dateStarted": "Jan 22, 2018 8:31:30 PM",
      "dateFinished": "Jan 22, 2018 8:32:30 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//IDF DESCENDING ORDER\naggDF.sort($\"meanTFIDF\".desc).show()",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 27, 2018 11:49:34 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [
          {
            "id": 16,
            "jobUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516447601162_0002/jobs/job?spark\u003dtrue\u0026id\u003d16",
            "numTasks": 440,
            "numCompletedTasks": 440,
            "stages": [
              {
                "id": 27,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516447601162_0002/stages/stage/?id\u003d27\u0026attempt\u003d0",
                "numCompleteTasks": 200,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 200
              },
              {
                "id": 24,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516447601162_0002/stages/stage/?id\u003d24\u0026attempt\u003d0",
                "numCompleteTasks": 20,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 20
              },
              {
                "id": 25,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516447601162_0002/stages/stage/?id\u003d25\u0026attempt\u003d0",
                "numCompleteTasks": 200,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 200
              },
              {
                "id": 26,
                "completed": true,
                "stageUrl": "https://azure.qubole.com/cluster-proxy?encodedUrl\u003dhttp%3A%2F%2F10.0.0.5%3A8088%2Fproxy%2Fapplication_1516447601162_0002/stages/stage/?id\u003d26\u0026attempt\u003d0",
                "numCompleteTasks": 20,
                "numActiveTasks": 0,
                "numFailedTasks": 0,
                "numTotalTasks": 20
              }
            ],
            "status": "Success"
          }
        ],
        "numCompletedTasks": 440,
        "numTasks": 440,
        "truncated": false
      },
      "jobName": "paragraph_1516451852431_1661590422",
      "id": "20180120-123732_1582133123_q_G5FRE4ZKXB1516650111",
      "dateCreated": "Jan 20, 2018 12:37:32 PM",
      "dateStarted": "Jan 20, 2018 1:08:49 PM",
      "dateFinished": "Jan 20, 2018 1:09:40 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n# High \u0026 Low TF-IDF scores\n\nIt might seem counter-intuitive that tokens like `highly recommend` \u0026 `much better` are the **least relevant** for reviews of highly rated products.  However, think in terms of Information Retrieval and Search Queries.  Suppose you were searching for review that was *similar* to a search string of 3 bigrams \"`highly recommend`, `blu ray`, and `rt2870 ralink`\".  Which of those bigrams do you think is most relevant in finding similar reviews?  `rt2870 ralink` obviously and see how that bigram has one of the highest TF-IDF scores. \n\nHowever, we\u0027re not trying to find similar reviews.  We\u0027re trying to assign numerical values to bigrams so that if 2 bigrams are similar then there numerical values are similar as well.  If we used TF alone, then both `highly recommend` and `blu ray` would have similar numerical values, despite not having conceptually similar meaning in the context of good reviews.  However, note how TF-IDF value of `blu ray` is not among the smallest like `highly recommend` and hence `highly recommend` and `blu ray` are NOT as similar to each other and hence TF-IDF does a better job than pure TF at distinguishing the meaning of terms with numerica values.",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 25, 2018 7:16:23 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1516907775274_-1652286325",
      "id": "20180125-191615_2051034891_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eHigh \u0026amp; Low TF-IDF scores\u003c/h1\u003e\n\u003cp\u003eIt might seem counter-intuitive that tokens like \u003ccode\u003ehighly recommend\u003c/code\u003e \u0026amp; \u003ccode\u003emuch better\u003c/code\u003e are the \u003cstrong\u003eleast relevant\u003c/strong\u003e for reviews of highly rated products. However, think in terms of Information Retrieval and Search Queries. Suppose you were searching for review that was \u003cem\u003esimilar\u003c/em\u003e to a search string of 3 bigrams \u0026ldquo;\u003ccode\u003ehighly recommend\u003c/code\u003e, \u003ccode\u003eblu ray\u003c/code\u003e, and \u003ccode\u003ert2870 ralink\u003c/code\u003e\u0026rdquo;. Which of those bigrams do you think is most relevant in finding similar reviews? \u003ccode\u003ert2870 ralink\u003c/code\u003e obviously and see how that bigram has one of the highest TF-IDF scores. \u003c/p\u003e\n\u003cp\u003eHowever, we\u0026rsquo;re not trying to find similar reviews. We\u0026rsquo;re trying to assign numerical values to bigrams so that if 2 bigrams are similar then there numerical values are similar as well. If we used TF alone, then both \u003ccode\u003ehighly recommend\u003c/code\u003e and \u003ccode\u003eblu ray\u003c/code\u003e would have similar numerical values, despite not having conceptually similar meaning in the context of good reviews. However, note how TF-IDF value of \u003ccode\u003eblu ray\u003c/code\u003e is not among the smallest like \u003ccode\u003ehighly recommend\u003c/code\u003e and hence \u003ccode\u003ehighly recommend\u003c/code\u003e and \u003ccode\u003eblu ray\u003c/code\u003e are NOT as similar to each other and hence TF-IDF does a better job than pure TF at distinguishing the meaning of terms with numerica values.\u003c/p\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "Jan 25, 2018 7:16:15 PM",
      "dateStarted": "Jan 25, 2018 7:16:18 PM",
      "dateFinished": "Jan 25, 2018 7:16:18 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "",
      "user": "davidgillen@precocityllc.com",
      "dateUpdated": "Jan 20, 2018 1:07:31 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "jobName": "paragraph_1516452699798_-1760939868",
      "id": "20180120-125139_1470837255_q_G5FRE4ZKXB1516650111",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": ""
      },
      "dateCreated": "Jan 20, 2018 12:51:39 PM",
      "dateStarted": "Jan 20, 2018 1:09:47 PM",
      "dateFinished": "Jan 20, 2018 1:09:47 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "NLP_PreProcessor",
  "id": "G5FRE4ZKXB1516650111",
  "angularObjects": {
    "2CZWJU1KG6631510262503868:shared_process": [],
    "2CX6ZKXWX6631510262503831:shared_process": [],
    "2D2QWKN8P6631515718565166:G5FRE4ZKXB1516650111": [],
    "2CZXHXM1R6631510262503821:shared_process": []
  },
  "config": {
    "isDashboard": false
  },
  "info": {},
  "source": "FCN"
}